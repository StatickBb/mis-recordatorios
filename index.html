<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mis Recordatorios</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f4f8;
    padding: 20px;
    max-width: 500px;
    margin: auto;
}

h2 {
    text-align: center;
}

input, select, button {
    width: 100%;
    padding: 10px;
    margin-top: 8px;
    box-sizing: border-box;
    font-size: 16px;
}

button {
    background: #4CAF50;
    color: white;
    border: none;
    border-radius: 6px;
}

.recordatorio {
    background: white;
    padding: 12px;
    margin-top: 12px;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.vencido {
    border-left: 5px solid red;
}

.completado {
    text-decoration: line-through;
    opacity: 0.6;
}
</style>
</head>

<body>

<h2>üìÖ Mis Recordatorios</h2>

<input type="date" id="fecha">
<input type="time" id="hora">
<input type="text" id="texto" placeholder="Escribe tu recordatorio">

<select id="repetir">
    <option value="no">Una sola vez</option>
    <option value="diario">Repetir diario</option>
</select>

<button onclick="guardar()">Guardar</button>

<div id="lista"></div>

<script>

let recordatorios = JSON.parse(localStorage.getItem("recordatorios")) || [];

function guardar() {
    let fecha = document.getElementById("fecha").value;
    let hora = document.getElementById("hora").value;
    let texto = document.getElementById("texto").value;
    let repetir = document.getElementById("repetir").value;

    if (!fecha || !hora || !texto) {
        alert("Completa todos los campos");
        return;
    }

    recordatorios.push({
        fecha,
        hora,
        texto,
        repetir,
        completado: false,
        notificado: false
    });

    guardarLocal();
    document.getElementById("texto").value = "";
    mostrar();
}

function guardarLocal() {
    localStorage.setItem("recordatorios", JSON.stringify(recordatorios));
}

function mostrar() {
    let lista = document.getElementById("lista");
    lista.innerHTML = "";

    recordatorios.sort((a, b) =>
        new Date(a.fecha + " " + a.hora) -
        new Date(b.fecha + " " + b.hora)
    );

    let ahora = new Date();

    recordatorios.forEach((r, index) => {

        let fechaHora = new Date(r.fecha + " " + r.hora);
        let vencido = fechaHora < ahora && !r.completado ? "recordatorio vencido" : "recordatorio";

        lista.innerHTML += `
            <div class="${vencido}">
                <input type="checkbox" ${r.completado ? "checked" : ""} 
                onchange="toggle(${index})">

                <strong>${r.fecha} ${r.hora}</strong>
                <div class="${r.completado ? "completado" : ""}">
                    ${r.texto}
                </div>
                <small>${r.repetir === "diario" ? "üîÅ Diario" : ""}</small>
                <button onclick="eliminar(${index})">Eliminar</button>
            </div>
        `;
    });
}

function toggle(index) {
    recordatorios[index].completado = !recordatorios[index].completado;
    guardarLocal();
    mostrar();
}

function eliminar(index) {
    recordatorios.splice(index, 1);
    guardarLocal();
    mostrar();
}

// üîî Sistema de notificaci√≥n + repetici√≥n diaria
setInterval(() => {

    let ahora = new Date();

    recordatorios.forEach(r => {

        let fechaHora = new Date(r.fecha + " " + r.hora);

        if (!r.completado && fechaHora <= ahora) {

            alert("üîî Recordatorio: " + r.texto);

            if (r.repetir === "diario") {

                let nuevaFecha = new Date(fechaHora);
                nuevaFecha.setDate(nuevaFecha.getDate() + 1);

                r.fecha = nuevaFecha.toISOString().split("T")[0];
                r.notificado = false;

            } else {
                r.notificado = true;
            }

            guardarLocal();
        }

    });

    mostrar();

}, 30000);

mostrar();

</script>

</body>
</html>
